# Script to change multiple user's passwords. Make sure you have a text file with usernames separated with a carriage return for the script to work.
$list = read-host -prompt "`nEnter file location of user list 'E.G. C:\users.txt'" ;
$users = Get-Content $list; 
$users | Unlock-ADAccount ; 
$newpw = Read-Host -Prompt "Enter new password" -AsSecureString ; 
$users | Set-ADAccountPassword -NewPassword $newpw ; 
$users | Set-ADUser -ChangePasswordAtLogon $true
Write-Host "`nPasswords changed for $users and accounts unlocked!" ; Start-Sleep -Seconds 3
