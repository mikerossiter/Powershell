# Looped script to reset passwords for Active Directory users. If name doesn't exist then it will fail. Loop will end when you enter nothing.
do {
	$name = read-host -prompt "`nEnter username or press enter to quit" ;
    if ($name -eq ""){exit -1}
    if ([bool] (Get-ADUser -Filter { SamAccountName -eq $name })) {Unlock-ADAccount -Identity $name ; Set-ADAccountPassword -Identity $name -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "password123" -Force) ; set-aduser -Identity $name -ChangePasswordAtLogon $true
    Write-Host "`n$name password has been reset to 'password123'"}
    else {write-host "`n$name does not exist"}
} until ($answer -eq "")
